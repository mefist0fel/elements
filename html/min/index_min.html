<html>
	<head>
		<title>Elements prot</title>
		<style type="text/css">
		body {
			display: block;
			background-color:0;
			width: 100%;
			height: 100%;
			margin: 0;
		}
		canvas {
			background-color:#ffffff;
			display: block;
			margin: 0px auto;
		}
		</style>
	</head>
	<body>
		<canvas id="tutorial"></canvas>
	</body>
	<script type="text/javascript">dev=document.addEventListener; function vAdd(e,t){return[e[0]+t[0],e[1]+t[1],e[2]+t[2]]}function vSub(e,t){return[e[0]-t[0],e[1]-t[1],e[2]-t[2]]}function magnitude(e,t){return Math.sqrt((e[0]-t[0])*(e[0]-t[0])+(e[1]-t[1])*(e[1]-t[1]))}function vNorm(e){return vMult(e,1/magnitude(e,[0,0,0]))}function vMult(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function vInRect(e,t){return e[0]>=t[0]&&e[0]<=t[2]&&e[1]>=t[1]&&e[1]<=t[3]}function Input(e,t){function i(e,t){n.key[e]=t}function s(e){i(e.keyCode,true)}function o(e){i(e.keyCode,false)}function u(e){}function a(e){n.mouseLeft=true}function f(e){n.mouseLeft=false}function l(t){n.mousePosition[0]=t.clientX-e.left;n.mousePosition[1]=t.clientY-e.top}function c(e){}function h(e){}var n={key:[200],mouseLeft:false,mousePosition:[0,0]};for(var r=0;r<200;r++){n.key[r]=false}dev("keydown",s,false);dev("keyup",o,false);dev("click",u,false);dev("mousedown",a,false);dev("mouseup",f,false);dev("mousemove",l,false);dev("touchstart",c,false);dev("touchmove",h,false);return n}function GameObject(){var e={active:false,position:[0,0,0],velocity:[0,0,0],life:100,radius:20};return e}function fire(e,t){for(var n=0;n<200;n++){if(!bullet[n].active){bullet[n].active=true;bullet[n].position=e;bullet[n].velocity=vMult(vAdd(t,[Math.random()*.1-.05,Math.random()*.1-.05,0]),400);bullet[n].life=3;break}}}function timestamp(){return window.performance&&window.performance.now?window.performance.now():(new Date).getTime()}function tS(e){var t=70;var n=40;var r=70;return[e[0]*t-e[1]*t+width*.5,e[0]*n+e[1]*n-e[2]*r]}function drawQuad(e){canvas.beginPath();var t=tS(e[0]);canvas.moveTo(t[0],t[1]);t=tS(e[1]);canvas.lineTo(t[0],t[1]);t=tS(e[2]);canvas.lineTo(t[0],t[1]);t=tS(e[3]);canvas.lineTo(t[0],t[1]);canvas.closePath();canvas.fill();canvas.stroke()}function grayScale(e){return"rgba("+e+","+e+","+e+",1)"}function drawTile(e,t,n){var r=40;var i=40;if((e+t)%2>.5){canvas.fillStyle=grayScale(240+n*10)}else{canvas.fillStyle=grayScale(230+n*10)}canvas.strokeStyle=canvas.fillStyle;drawQuad([[e,t,n],[e+1,t,n],[e+1,t+1,n],[e,t+1,n]]);canvas.fillStyle="#cccccc";drawQuad([[e+1,t,n],[e+1,t+1,n],[e+1,t+1,-1],[e+1,t,-1]]);canvas.fillStyle="#dddddd";drawQuad([[e,t+1,n],[e+1,t+1,n],[e+1,t+1,-1],[e,t+1,-1]]);canvas.fill()}function render(){canvas.fillStyle="#000000";canvas.fillRect(0,0,width,height);for(var e=0;e<16;e++){for(var t=0;t<16;t++){if(map[e*16+t]>0){drawTile(e,t,map[e*16+t]-1)}}}canvas.strokeStyle="#000000";canvas.fillStyle="rgba(0,0,0,0.2)";canvas.beginPath();canvas.font="20pt Arial";onMap=[Math.floor(player.position[0]),Math.floor(player.position[1])];canvas.fillText("coord "+onMap[0]+" "+onMap[1]+" "+map[onMap[0]*16+onMap[1]],10,30);if(map[onMap[0]*16+onMap[1]]>=1){var n=tS([player.position[0],player.position[1],0]);canvas.arc(n[0],n[1],Math.max(player.radius*(2-player.position[2])*.5,3),0,2*Math.PI);canvas.closePath();canvas.fill()}canvas.fillStyle="#FF0000";canvas.beginPath();var r=tS(player.position);canvas.arc(r[0],r[1],player.radius,0,2*Math.PI);canvas.closePath();canvas.fill();canvas.fillStyle="#FFFFFF";canvas.beginPath();r=tS(player.position);canvas.arc(r[0]+player.radius*.3,r[1]-player.radius*.3,player.radius*.2,0,2*Math.PI);canvas.closePath();canvas.fill();canvas.strokeRect(400,400,100,100);canvas.beginPath();canvas.arc(200,400,50,0,2*Math.PI);canvas.closePath();canvas.stroke();for(var e=0;e<200;e++){if(bullet[e].active){canvas.fillRect(bullet[e].position[0]-1,bullet[e].position[1]-1,2,2)}}}function update(e){player.velocity=[0,0,player.velocity[2]];if(input.key[38]||input.key[87]){player.velocity=vAdd(player.velocity,[-1,-1,0])}if(input.key[40]||input.key[83]){player.velocity=vAdd(player.velocity,[+1,+1,0])}if(input.key[37]||input.key[65]){player.velocity=vAdd(player.velocity,[-1,1,0])}if(input.key[39]||input.key[68]){player.velocity=vAdd(player.velocity,[1,-1,0])}if(input.key[32]&&player.position[2]<=.2){player.velocity=vAdd(player.velocity,[0,0,3])}if(input.mouseLeft){fire(player.position,vNorm(vSub(input.mousePosition,player.position)))}player.velocity[2]-=3*e;newCoord=vAdd(player.position,vMult(player.velocity,e));points=[[400,400,0],[500,400,0],[500,500,0],[400,500,0]];for(var t=0;t<4;t++){dist=magnitude(newCoord,points[t]);if(dist<=player.radius){newCoord=vAdd(newCoord,vMult(vNorm(vSub(points[t],newCoord)),dist-player.radius))}}if(vInRect(newCoord,[400-player.radius,400,500+player.radius,500])){if(newCoord[0]<450){newCoord[0]=400-player.radius}else{newCoord[0]=500+player.radius}}if(vInRect(newCoord,[400,400-player.radius,500,500+player.radius])){if(newCoord[1]<450){newCoord[1]=400-player.radius}else{newCoord[1]=500+player.radius}}dist=magnitude(newCoord,[200,400]);if(dist<player.radius+50){newCoord=vAdd(newCoord,vMult(vNorm(vSub([200,400],newCoord)),dist-player.radius-50))}if(newCoord[2]<.2){player.velocity[2]=0;newCoord[2]=.2}player.position=newCoord;for(var t=0;t<200;t++){if(bullet[t].active){bullet[t].position=vAdd(bullet[t].position,vMult(bullet[t].velocity,e));bullet[t].life-=e;if(bullet[t].life<0){bullet[t].active=false}}}}function frame(){now=timestamp();dt=dt+Math.min(1,(now-time)/1e3);if(dt>step){dt=step}update(step);render();time=now;requestAnimationFrame(frame)}var map=[1,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,2,1,0,0,1,0,0,0,1,1,0,0,1,0,0,1,2,2,1,1,0,0,0,1,1,1,0,1,0,0,0,1,1,1,1,1,1,0,0,0,0,0,1,1,1,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,1,1,0,0,0,0,0,1,1,1,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,1,0,0,1,0,0,0,1,1,0,0,1,0,0,1,1,1,0,1,0,0,0,1,1,1,0,1,0,0,0,0,0,0,1,1,1,0,0,0,0,0,1,1,1,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,1,1,0,0,0,0,0,1,1,1,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0];var now,dt=0,time=timestamp(),step=1/30,ballRadius=20,width=1024,height=768;var cameraPosition=[0,0,0];var canvasElement=document.getElementById("tutorial");var canvas=canvasElement.getContext("2d");canvasElement.width=width;canvasElement.height=height;rect=canvasElement.getBoundingClientRect();var input=Input(rect,canvasElement);var player=GameObject();player.position=[3,3,.3];var bullet=[200];for(var i=0;i<200;i++){bullet[i]=GameObject()}requestAnimationFrame(frame)
	</script>
</html>